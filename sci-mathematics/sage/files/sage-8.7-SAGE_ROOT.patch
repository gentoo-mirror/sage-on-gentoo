diff --git a/sage/doctest/control.py b/sage/doctest/control.py
index 96143a6..870511e 100644
--- a/sage/doctest/control.py
+++ b/sage/doctest/control.py
@@ -693,8 +693,11 @@ class DocTestController(SageObject):
         """
         opj = os.path.join
         from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_ROOT
-        DOT_GIT = opj(SAGE_ROOT, '.git')
-        have_git = os.path.exists(DOT_GIT)
+        if SAGE_ROOT is None:
+            have_git = False
+        else:
+            DOT_GIT = opj(SAGE_ROOT, '.git')
+            have_git = os.path.exists(DOT_GIT)
 
         def all_files():
             self.files.append(opj(SAGE_SRC, 'sage'))
@@ -1200,7 +1203,10 @@ class DocTestController(SageObject):
             self.test_safe_directory()
             self.create_run_id()
             from sage.env import SAGE_ROOT
-            DOT_GIT = os.path.join(SAGE_ROOT, '.git')
+            if SAGE_ROOT is None:
+                DOT_GIT = ""
+            else:
+                DOT_GIT = os.path.join(SAGE_ROOT, '.git')
             if os.path.isdir(DOT_GIT):
                 import subprocess
                 try:
diff --git a/sage/misc/citation.pyx b/sage/misc/citation.pyx
index dd59e70..3145a59 100644
--- a/sage/misc/citation.pyx
+++ b/sage/misc/citation.pyx
@@ -5,7 +5,7 @@ Dependency usage tracking for citations
 from __future__ import absolute_import
 
 from sage.misc.all import tmp_filename
-from sage.env import SAGE_ROOT
+from sage.env import SAGE_LOCAL
 
 systems = {}
 systems['PARI'] = ['cypari2', 'sage.interfaces.gp']
@@ -112,7 +112,7 @@ def get_systems(cmd):
     stats = pstats.Stats(filename)
 
     #Strings is a list of method names and modules which get run
-    strings = [a[0].replace(SAGE_ROOT, "") + " " + a[2]
+    strings = [a[0].replace(SAGE_LOCAL, "") + " " + a[2]
                for a in stats.stats]
 
     #Remove trivial functions
diff --git a/sage/misc/inline_fortran.py b/sage/misc/inline_fortran.py
index fe2565c..092b504 100644
--- a/sage/misc/inline_fortran.py
+++ b/sage/misc/inline_fortran.py
@@ -141,12 +141,12 @@ class InlineFortran:
 
         TESTS::
 
-            sage: os.chdir(SAGE_ROOT)
+            sage: os.chdir(DOT_SAGE)
             sage: fortran.eval("SYNTAX ERROR !@#$")
             Traceback (most recent call last):
             ...
             RuntimeError: failed to compile Fortran code:...
-            sage: os.getcwd() == SAGE_ROOT
+            sage: os.getcwd() == DOT_SAGE
             True
         """
         if globals is None:
diff --git a/sage/misc/misc.py b/sage/misc/misc.py
index 8860669..939c53b 100644
--- a/sage/misc/misc.py
+++ b/sage/misc/misc.py
@@ -76,7 +76,7 @@ def sage_makedirs(dir):
     The following fails because we are trying to create a directory in
     place of an ordinary file (the main Sage executable)::
 
-        sage: sage_executable = os.path.join(SAGE_ROOT, 'sage')
+        sage: sage_executable = os.path.join(SAGE_LOCAL, 'bin', 'sage')
         sage: sage_makedirs(sage_executable)
         Traceback (most recent call last):
         ...
