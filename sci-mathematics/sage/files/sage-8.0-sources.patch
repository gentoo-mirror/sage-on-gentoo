diff -Naur src.orig/sage/doctest/sources.py src/sage/doctest/sources.py
--- src.orig/sage/doctest/sources.py	2017-04-04 14:28:13.854890912 +1200
+++ src/sage/doctest/sources.py	2017-04-04 14:28:35.094572487 +1200
@@ -33,7 +33,7 @@
 from .parsing import SageDocTestParser
 from .util import NestedName
 from sage.structure.dynamic_class import dynamic_class
-from sage.env import SAGE_SRC, SAGE_LOCAL
+from sage.env import SAGE_SRC, SAGE_LOCAL, SAGE_LIB
 
 # Python file parsing
 triple_quotes = re.compile("\s*[rRuU]*((''')|(\"\"\"))")
@@ -86,7 +86,7 @@
     # If the file is in the sage library, we can use our knowledge of
     # the directory structure
     dev = SAGE_SRC
-    sp = os.path.join(SAGE_LOCAL, 'lib', 'python', 'site-packages')
+    sp = SAGE_LIB
     if path.startswith(dev):
         # there will be a branch name
         i = path.find(os.path.sep, len(dev))
diff -Naur src.orig/sage_setup/docbuild/__init__.py src/sage_setup/docbuild/__init__.py
--- src.orig/sage_setup/docbuild/__init__.py	2017-04-04 14:28:13.884890465 +1200
+++ src/sage_setup/docbuild/__init__.py	2017-04-04 14:28:35.094572487 +1200
@@ -25,7 +25,7 @@
 from sage.misc.misc import sage_makedirs
 from sage.env import SAGE_DOC_SRC, SAGE_DOC, SAGE_SRC
 
-from .build_options import (LANGUAGES, SPHINXOPTS, PAPER, OMIT,
+from sage_setup.docbuild.build_options import (LANGUAGES, SPHINXOPTS, PAPER, OMIT,
      PAPEROPTS, ALLSPHINXOPTS, NUM_THREADS, WEBSITESPHINXOPTS,
      INCREMENTAL_BUILD, ABORT_ON_ERROR)
 
diff -Naur src.orig/sage_setup/docbuild/__main__.py src/sage_setup/docbuild/__main__.py
--- src.orig/sage_setup/docbuild/__main__.py	2017-04-04 14:28:13.884890465 +1200
+++ src/sage_setup/docbuild/__main__.py	2017-04-04 14:28:35.094572487 +1200
@@ -1,20 +1,2 @@
-from . import main
+from sage_setup.docbuild import main
 main()
-
-# Remove old documentation
-import os
-from sage.env import SAGE_DOC_SRC, SAGE_DOC
-old_doc = os.path.join(SAGE_DOC_SRC, "output")
-
-if os.path.exists(old_doc):
-    try:
-        os.unlink(old_doc)
-    except OSError:
-        from shutil import rmtree
-        rmtree(old_doc)
-
-# Add symlink ouput -> . inside SAGE_DOC (for backwards compatibility)
-try:
-    os.symlink(".", os.path.join(SAGE_DOC, "output"))
-except OSError:
-    pass
diff -Naur src.orig/sage_setup/find.py src/sage_setup/find.py
--- src.orig/sage_setup/find.py	2017-04-04 14:28:13.884890465 +1200
+++ src/sage_setup/find.py	2017-04-04 14:28:35.094572487 +1200
@@ -114,7 +114,7 @@
         cydir = os.path.join(cythonized_dir, dir)
 
         files = [os.path.join(sdir, f) for f in os.listdir(sdir)
-                if f.endswith((".pxd", ".pxi")) or f in special_filenames]
+                if f.endswith((".pxd", ".pxi", ".pyx", ".rst")) or f in special_filenames]
         if os.path.isdir(cydir):  # Not every directory contains Cython files
             files += [os.path.join(cydir, f) for f in os.listdir(cydir)
                     if f.endswith(".h")]
diff -Naur src.orig/setup.py src/setup.py
--- src.orig/setup.py	2017-04-04 14:28:13.884890465 +1200
+++ src/setup.py	2017-04-04 14:31:17.872133350 +1200
@@ -827,7 +827,7 @@
 t = time.time()
 from sage_setup.find import find_python_sources
 python_packages, python_modules = find_python_sources(
-    SAGE_SRC, ['sage', 'sage_setup'])
+    SAGE_SRC, ['sage'])
 
 log.debug('python_packages = {0}'.format(python_packages))
 
@@ -842,10 +842,6 @@
     def run(self):
         install.run(self)
         self.install_kernel_spec()
-        log.info('Cleaning up stale installed files....')
-        t = time.time()
-        self.clean_stale_files()
-        log.info('Finished cleaning, time: %.2f seconds.' % (time.time() - t))
 
     def install_kernel_spec(self):
         """
@@ -856,7 +852,7 @@
             The files are generated, not copied. Therefore, we cannot
             use ``data_files`` for this.
         """
-        from sage.repl.ipython_kernel.install import SageKernelSpec
+        from sage_setup.jupyter.install import SageKernelSpec
         SageKernelSpec.update()
 
     def clean_stale_files(self):
